/home/jin509/anaconda3/envs/opendit/lib/python3.10/site-packages/transformers/utils/generic.py:441: UserWarning: torch.utils._pytree._register_pytree_node is deprecated. Please use torch.utils._pytree.register_pytree_node instead.
  _torch_pytree._register_pytree_node(
/home/jin509/anaconda3/envs/opendit/lib/python3.10/site-packages/transformers/utils/generic.py:309: UserWarning: torch.utils._pytree._register_pytree_node is deprecated. Please use torch.utils._pytree.register_pytree_node instead.
  _torch_pytree._register_pytree_node(
/home/jin509/anaconda3/envs/opendit/lib/python3.10/site-packages/transformers/utils/generic.py:309: UserWarning: torch.utils._pytree._register_pytree_node is deprecated. Please use torch.utils._pytree.register_pytree_node instead.
  _torch_pytree._register_pytree_node(
/home/jin509/anaconda3/envs/opendit/lib/python3.10/site-packages/transformers/utils/generic.py:309: UserWarning: torch.utils._pytree._register_pytree_node is deprecated. Please use torch.utils._pytree.register_pytree_node instead.
  _torch_pytree._register_pytree_node(
/home/jin509/anaconda3/envs/opendit/lib/python3.10/site-packages/diffusers/models/transformers/transformer_2d.py:34: FutureWarning: `Transformer2DModelOutput` is deprecated and will be removed in version 1.0.0. Importing `Transformer2DModelOutput` from `diffusers.models.transformer_2d` is deprecated and this will be removed in a future version. Please use `from diffusers.models.modeling_outputs import Transformer2DModelOutput`, instead.
  deprecate("Transformer2DModelOutput", "1.0.0", deprecation_message)
[06/29/24 23:02:37] INFO     colossalai - colossalai - INFO: /home/jin509/anaconda3/envs/opendit/lib/python3.10/site-packages/colossalai/initialize.py:60 launch
                    INFO     colossalai - colossalai - INFO: Distributed environment is initialized, world size: 1

Init SkipManager:
                steps=30
                cross_skip=True, cross_threshold=[540, 960], cross_gap=6
                spatial_skip=True, spatial_threshold=[540, 920], spatial_gap=2, spatial_layer_range=[0, 28]
                temporal_skip=True, temporal_threshold=[540, 960], temporal_gap=4
                diffusion_skip=True, diffusion_timestep_respacing=None

[[34m2024-06-29 23:02:37[0m] Inference configuration: Namespace(config='configs/opensora/sample_skip_6.yaml', seed=42, batch_size=1, flash_attn=True, resolution='480p', multi_resolution='STDiT2', dtype='bf16', save_dir='./samples/opensora', num_sample=1, prompt_as_path=True, verbose=2, prompt_path=None, prompt=['a cat wearing sunglasses and working as a lifeguard at pool.', 'A dog in astronaut suit and sunglasses floating in space.'], llm_refine=False, num_frames=48, fps=24, image_size=None, frame_interval=1, aspect_ratio='9:16', watermark=False, num_sampling_steps=30, cfg_scale=7.0, loop=1, align=5, condition_frame_length=5, condition_frame_edit=0.0, reference_path=None, mask_strategy=None, aes=6.5, flow=None, camera_motion=None, spatial_skip=True, spatial_threshold=[540, 920], spatial_gap=2, spatial_block=[0, 28], temporal_skip=True, temporal_threshold=[540, 960], temporal_gap=4, cross_skip=True, cross_threshold=[540, 960], cross_gap=6, mlp_skip=True, mlp_threshold=[710, 760], mlp_gap=1, mlp_layer_range=[14, 15], mlp_skip_config={496: [0, 1, 2, 3], 544: [0, 1, 2, 3, 4, 5, 6, 7, 8], 628: [0, 1, 2, 3, 4, 5, 6, 7, 8], 752: [0, 1, 2, 3, 4, 5, 6, 7, 8], 836: [0, 1, 2, 3, 4, 5, 6, 7, 8], 776: [0, 1, 2, 3, 4, 5, 6, 7, 8], 220: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18]}, diffusion_skip=True, diffusion_skip_timestep=[1, 1, 1, 0, 0, 0, 0, 0, 0, 0])

[[34m2024-06-29 23:02:37[0m] Building models...
/home/jin509/anaconda3/envs/opendit/lib/python3.10/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
You are using the default legacy behaviour of the <class 'transformers.models.t5.tokenization_t5.T5Tokenizer'>. This is expected, and simply means that the `legacy` (previous) behavior will be used so nothing changes for you. If you want to use the new behaviour, set `legacy=False`. This should only be set if you understand what it means, and thouroughly read the reason why this was added as explained in https://github.com/huggingface/transformers/pull/24565

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:18<00:18, 18.73s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:26<00:00, 12.13s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:26<00:00, 13.12s/it]
save_dir | ./samples/opensora/mlp_skip_68

  0%|          | 0/27 [00:00<?, ?it/s]
  4%|▎         | 1/27 [00:06<02:54,  6.71s/it]
  7%|▋         | 2/27 [00:09<01:43,  4.14s/it]
 11%|█         | 3/27 [00:11<01:19,  3.32s/it]
 15%|█▍        | 4/27 [00:12<00:59,  2.60s/it]
 19%|█▊        | 5/27 [00:15<00:53,  2.43s/it]
 22%|██▏       | 6/27 [00:15<00:40,  1.93s/it]
 26%|██▌       | 7/27 [00:17<00:37,  1.86s/it]
 30%|██▉       | 8/27 [00:18<00:29,  1.57s/it]
 33%|███▎      | 9/27 [00:20<00:31,  1.75s/it]
 37%|███▋      | 10/27 [00:21<00:25,  1.51s/it]
 41%|████      | 11/27 [00:23<00:25,  1.58s/it]Skip | Using stored MLP output | Spatial | t 820 | previous 836 | block 0
Skip | Using stored MLP output | Time | t 820 | previous 836 | block 0
Skip | Using stored MLP output | Spatial | t 820 | previous 836 | block 1
Skip | Using stored MLP output | Time | t 820 | previous 836 | block 1
Skip | Using stored MLP output | Spatial | t 820 | previous 836 | block 2
Skip | Using stored MLP output | Time | t 820 | previous 836 | block 2
Skip | Using stored MLP output | Spatial | t 820 | previous 836 | block 3
Skip | Using stored MLP output | Time | t 820 | previous 836 | block 3
Skip | Using stored MLP output | Spatial | t 820 | previous 836 | block 4
Skip | Using stored MLP output | Time | t 820 | previous 836 | block 4
Skip | Using stored MLP output | Spatial | t 820 | previous 836 | block 5
Skip | Using stored MLP output | Time | t 820 | previous 836 | block 5
Skip | Using stored MLP output | Spatial | t 820 | previous 836 | block 6
Skip | Using stored MLP output | Time | t 820 | previous 836 | block 6
Skip | Using stored MLP output | Spatial | t 820 | previous 836 | block 7
Skip | Using stored MLP output | Time | t 820 | previous 836 | block 7
Skip | Using stored MLP output | Spatial | t 820 | previous 836 | block 8
Skip | Using stored MLP output | Time | t 820 | previous 836 | block 8

 44%|████▍     | 12/27 [00:24<00:19,  1.32s/it]
 48%|████▊     | 13/27 [00:26<00:22,  1.63s/it]
 52%|█████▏    | 14/27 [00:27<00:18,  1.43s/it]
 56%|█████▌    | 15/27 [00:29<00:17,  1.45s/it]Skip | Using stored MLP output | Spatial | t 724 | previous 752 | block 0
Skip | Using stored MLP output | Time | t 724 | previous 752 | block 0
Skip | Using stored MLP output | Spatial | t 724 | previous 752 | block 1
Skip | Using stored MLP output | Time | t 724 | previous 752 | block 1
Skip | Using stored MLP output | Spatial | t 724 | previous 752 | block 2
Skip | Using stored MLP output | Time | t 724 | previous 752 | block 2
Skip | Using stored MLP output | Spatial | t 724 | previous 752 | block 3
Skip | Using stored MLP output | Time | t 724 | previous 752 | block 3
Skip | Using stored MLP output | Spatial | t 724 | previous 752 | block 4
Skip | Using stored MLP output | Time | t 724 | previous 752 | block 4
Skip | Using stored MLP output | Spatial | t 724 | previous 752 | block 5
Skip | Using stored MLP output | Time | t 724 | previous 752 | block 5
Skip | Using stored MLP output | Spatial | t 724 | previous 752 | block 6
Skip | Using stored MLP output | Time | t 724 | previous 752 | block 6
Skip | Using stored MLP output | Spatial | t 724 | previous 752 | block 7
Skip | Using stored MLP output | Time | t 724 | previous 752 | block 7
Skip | Using stored MLP output | Spatial | t 724 | previous 752 | block 8
Skip | Using stored MLP output | Time | t 724 | previous 752 | block 8

 59%|█████▉    | 16/27 [00:29<00:13,  1.23s/it]
 63%|██████▎   | 17/27 [00:31<00:15,  1.51s/it]
 67%|██████▋   | 18/27 [00:32<00:12,  1.35s/it]
 70%|███████   | 19/27 [00:34<00:11,  1.46s/it]Skip | Using stored MLP output | Spatial | t 588 | previous 628 | block 0
Skip | Using stored MLP output | Time | t 588 | previous 628 | block 0
Skip | Using stored MLP output | Spatial | t 588 | previous 628 | block 1
Skip | Using stored MLP output | Time | t 588 | previous 628 | block 1
Skip | Using stored MLP output | Spatial | t 588 | previous 628 | block 2
Skip | Using stored MLP output | Time | t 588 | previous 628 | block 2
Skip | Using stored MLP output | Spatial | t 588 | previous 628 | block 3
Skip | Using stored MLP output | Time | t 588 | previous 628 | block 3
Skip | Using stored MLP output | Spatial | t 588 | previous 628 | block 4
Skip | Using stored MLP output | Time | t 588 | previous 628 | block 4
Skip | Using stored MLP output | Spatial | t 588 | previous 628 | block 5
Skip | Using stored MLP output | Time | t 588 | previous 628 | block 5
Skip | Using stored MLP output | Spatial | t 588 | previous 628 | block 6
Skip | Using stored MLP output | Time | t 588 | previous 628 | block 6
Skip | Using stored MLP output | Spatial | t 588 | previous 628 | block 7
Skip | Using stored MLP output | Time | t 588 | previous 628 | block 7
Skip | Using stored MLP output | Spatial | t 588 | previous 628 | block 8
Skip | Using stored MLP output | Time | t 588 | previous 628 | block 8

 74%|███████▍  | 20/27 [00:35<00:08,  1.24s/it]
 78%|███████▊  | 21/27 [00:37<00:09,  1.51s/it]Skip | Using stored MLP output | Spatial | t 496 | previous 544 | block 4
Skip | Using stored MLP output | Time | t 496 | previous 544 | block 4
Skip | Using stored MLP output | Spatial | t 496 | previous 544 | block 5
Skip | Using stored MLP output | Time | t 496 | previous 544 | block 5
Skip | Using stored MLP output | Spatial | t 496 | previous 544 | block 6
Skip | Using stored MLP output | Time | t 496 | previous 544 | block 6
Skip | Using stored MLP output | Spatial | t 496 | previous 544 | block 7
Skip | Using stored MLP output | Time | t 496 | previous 544 | block 7
Skip | Using stored MLP output | Spatial | t 496 | previous 544 | block 8
Skip | Using stored MLP output | Time | t 496 | previous 544 | block 8

 81%|████████▏ | 22/27 [00:39<00:08,  1.74s/it]Skip | Using stored MLP output | Spatial | t 440 | previous 496 | block 0
Skip | Using stored MLP output | Time | t 440 | previous 496 | block 0
Skip | Using stored MLP output | Spatial | t 440 | previous 496 | block 1
Skip | Using stored MLP output | Time | t 440 | previous 496 | block 1
Skip | Using stored MLP output | Spatial | t 440 | previous 496 | block 2
Skip | Using stored MLP output | Time | t 440 | previous 496 | block 2
Skip | Using stored MLP output | Spatial | t 440 | previous 496 | block 3
Skip | Using stored MLP output | Time | t 440 | previous 496 | block 3

 85%|████████▌ | 23/27 [00:41<00:07,  1.89s/it]
 89%|████████▉ | 24/27 [00:44<00:06,  2.04s/it]
 93%|█████████▎| 25/27 [00:46<00:04,  2.14s/it]
 96%|█████████▋| 26/27 [00:49<00:02,  2.27s/it]Skip | Using stored MLP output | Spatial | t 119 | previous 220 | block 0
Skip | Using stored MLP output | Time | t 119 | previous 220 | block 0
Skip | Using stored MLP output | Spatial | t 119 | previous 220 | block 1
Skip | Using stored MLP output | Time | t 119 | previous 220 | block 1
Skip | Using stored MLP output | Spatial | t 119 | previous 220 | block 2
Skip | Using stored MLP output | Time | t 119 | previous 220 | block 2
Skip | Using stored MLP output | Spatial | t 119 | previous 220 | block 3
Skip | Using stored MLP output | Time | t 119 | previous 220 | block 3
Skip | Using stored MLP output | Spatial | t 119 | previous 220 | block 4
Skip | Using stored MLP output | Time | t 119 | previous 220 | block 4
Skip | Using stored MLP output | Spatial | t 119 | previous 220 | block 5
Skip | Using stored MLP output | Time | t 119 | previous 220 | block 5
Skip | Using stored MLP output | Spatial | t 119 | previous 220 | block 6
Skip | Using stored MLP output | Time | t 119 | previous 220 | block 6
Skip | Using stored MLP output | Spatial | t 119 | previous 220 | block 7
Skip | Using stored MLP output | Time | t 119 | previous 220 | block 7
Skip | Using stored MLP output | Spatial | t 119 | previous 220 | block 8
Skip | Using stored MLP output | Time | t 119 | previous 220 | block 8
Skip | Using stored MLP output | Spatial | t 119 | previous 220 | block 9
Skip | Using stored MLP output | Time | t 119 | previous 220 | block 9
Skip | Using stored MLP output | Spatial | t 119 | previous 220 | block 10
Skip | Using stored MLP output | Time | t 119 | previous 220 | block 10
Skip | Using stored MLP output | Spatial | t 119 | previous 220 | block 11
Skip | Using stored MLP output | Time | t 119 | previous 220 | block 11
Skip | Using stored MLP output | Spatial | t 119 | previous 220 | block 12
Skip | Using stored MLP output | Time | t 119 | previous 220 | block 12
Skip | Using stored MLP output | Spatial | t 119 | previous 220 | block 13
Skip | Using stored MLP output | Time | t 119 | previous 220 | block 13
Skip | Using stored MLP output | Spatial | t 119 | previous 220 | block 14
Skip | Using stored MLP output | Time | t 119 | previous 220 | block 14
Skip | Using stored MLP output | Spatial | t 119 | previous 220 | block 15
Skip | Using stored MLP output | Time | t 119 | previous 220 | block 15
Skip | Using stored MLP output | Spatial | t 119 | previous 220 | block 16
Skip | Using stored MLP output | Time | t 119 | previous 220 | block 16
Skip | Using stored MLP output | Spatial | t 119 | previous 220 | block 17
Skip | Using stored MLP output | Time | t 119 | previous 220 | block 17
Skip | Using stored MLP output | Spatial | t 119 | previous 220 | block 18
Skip | Using stored MLP output | Time | t 119 | previous 220 | block 18

100%|██████████| 27/27 [00:51<00:00,  2.14s/it]
100%|██████████| 27/27 [00:51<00:00,  1.89s/it]
[[34m2024-06-29 23:04:04[0m] Prompt: a cat wearing sunglasses and working as a lifeguard at pool. aesthetic score: 6.5.
Saved to ./samples/opensora/mlp_skip_68/a cat wearing sunglasses and working as .mp4

  0%|          | 0/27 [00:00<?, ?it/s]
  4%|▎         | 1/27 [00:02<01:01,  2.36s/it]
  7%|▋         | 2/27 [00:04<00:59,  2.37s/it]
 11%|█         | 3/27 [00:07<00:57,  2.38s/it]
 15%|█▍        | 4/27 [00:09<00:54,  2.38s/it]
 19%|█▊        | 5/27 [00:11<00:45,  2.06s/it]
 22%|██▏       | 6/27 [00:12<00:39,  1.88s/it]
 26%|██▌       | 7/27 [00:13<00:31,  1.58s/it]
 30%|██▉       | 8/27 [00:15<00:33,  1.77s/it]
 33%|███▎      | 9/27 [00:16<00:27,  1.52s/it]
 37%|███▋      | 10/27 [00:18<00:26,  1.59s/it]
 41%|████      | 11/27 [00:19<00:22,  1.40s/it]Skip | Using stored MLP output | Spatial | t 820 | previous 836 | block 0
Skip | Using stored MLP output | Time | t 820 | previous 836 | block 0
Skip | Using stored MLP output | Spatial | t 820 | previous 836 | block 1
Skip | Using stored MLP output | Time | t 820 | previous 836 | block 1
Skip | Using stored MLP output | Spatial | t 820 | previous 836 | block 2
Skip | Using stored MLP output | Time | t 820 | previous 836 | block 2
Skip | Using stored MLP output | Spatial | t 820 | previous 836 | block 3
Skip | Using stored MLP output | Time | t 820 | previous 836 | block 3
Skip | Using stored MLP output | Spatial | t 820 | previous 836 | block 4
Skip | Using stored MLP output | Time | t 820 | previous 836 | block 4
Skip | Using stored MLP output | Spatial | t 820 | previous 836 | block 5
Skip | Using stored MLP output | Time | t 820 | previous 836 | block 5
Skip | Using stored MLP output | Spatial | t 820 | previous 836 | block 6
Skip | Using stored MLP output | Time | t 820 | previous 836 | block 6
Skip | Using stored MLP output | Spatial | t 820 | previous 836 | block 7
Skip | Using stored MLP output | Time | t 820 | previous 836 | block 7
Skip | Using stored MLP output | Spatial | t 820 | previous 836 | block 8
Skip | Using stored MLP output | Time | t 820 | previous 836 | block 8

 44%|████▍     | 12/27 [00:21<00:23,  1.56s/it]
 48%|████▊     | 13/27 [00:22<00:19,  1.38s/it]
 52%|█████▏    | 14/27 [00:23<00:18,  1.42s/it]
 56%|█████▌    | 15/27 [00:24<00:15,  1.29s/it]Skip | Using stored MLP output | Spatial | t 724 | previous 752 | block 0
Skip | Using stored MLP output | Time | t 724 | previous 752 | block 0
Skip | Using stored MLP output | Spatial | t 724 | previous 752 | block 1
Skip | Using stored MLP output | Time | t 724 | previous 752 | block 1
Skip | Using stored MLP output | Spatial | t 724 | previous 752 | block 2
Skip | Using stored MLP output | Time | t 724 | previous 752 | block 2
Skip | Using stored MLP output | Spatial | t 724 | previous 752 | block 3
Skip | Using stored MLP output | Time | t 724 | previous 752 | block 3
Skip | Using stored MLP output | Spatial | t 724 | previous 752 | block 4
Skip | Using stored MLP output | Time | t 724 | previous 752 | block 4
Skip | Using stored MLP output | Spatial | t 724 | previous 752 | block 5
Skip | Using stored MLP output | Time | t 724 | previous 752 | block 5
Skip | Using stored MLP output | Spatial | t 724 | previous 752 | block 6
Skip | Using stored MLP output | Time | t 724 | previous 752 | block 6
Skip | Using stored MLP output | Spatial | t 724 | previous 752 | block 7
Skip | Using stored MLP output | Time | t 724 | previous 752 | block 7
Skip | Using stored MLP output | Spatial | t 724 | previous 752 | block 8
Skip | Using stored MLP output | Time | t 724 | previous 752 | block 8

 59%|█████▉    | 16/27 [00:26<00:17,  1.55s/it]
 63%|██████▎   | 17/27 [00:27<00:13,  1.38s/it]
 67%|██████▋   | 18/27 [00:29<00:12,  1.42s/it]
 70%|███████   | 19/27 [00:30<00:10,  1.29s/it]Skip | Using stored MLP output | Spatial | t 588 | previous 628 | block 0
Skip | Using stored MLP output | Time | t 588 | previous 628 | block 0
Skip | Using stored MLP output | Spatial | t 588 | previous 628 | block 1
Skip | Using stored MLP output | Time | t 588 | previous 628 | block 1
Skip | Using stored MLP output | Spatial | t 588 | previous 628 | block 2
Skip | Using stored MLP output | Time | t 588 | previous 628 | block 2
Skip | Using stored MLP output | Spatial | t 588 | previous 628 | block 3
Skip | Using stored MLP output | Time | t 588 | previous 628 | block 3
Skip | Using stored MLP output | Spatial | t 588 | previous 628 | block 4
Skip | Using stored MLP output | Time | t 588 | previous 628 | block 4
Skip | Using stored MLP output | Spatial | t 588 | previous 628 | block 5
Skip | Using stored MLP output | Time | t 588 | previous 628 | block 5
Skip | Using stored MLP output | Spatial | t 588 | previous 628 | block 6
Skip | Using stored MLP output | Time | t 588 | previous 628 | block 6
Skip | Using stored MLP output | Spatial | t 588 | previous 628 | block 7
Skip | Using stored MLP output | Time | t 588 | previous 628 | block 7
Skip | Using stored MLP output | Spatial | t 588 | previous 628 | block 8
Skip | Using stored MLP output | Time | t 588 | previous 628 | block 8

 74%|███████▍  | 20/27 [00:32<00:10,  1.48s/it]
 78%|███████▊  | 21/27 [00:33<00:07,  1.33s/it]Skip | Using stored MLP output | Spatial | t 496 | previous 544 | block 4
Skip | Using stored MLP output | Time | t 496 | previous 544 | block 4
Skip | Using stored MLP output | Spatial | t 496 | previous 544 | block 5
Skip | Using stored MLP output | Time | t 496 | previous 544 | block 5
Skip | Using stored MLP output | Spatial | t 496 | previous 544 | block 6
Skip | Using stored MLP output | Time | t 496 | previous 544 | block 6
Skip | Using stored MLP output | Spatial | t 496 | previous 544 | block 7
Skip | Using stored MLP output | Time | t 496 | previous 544 | block 7
Skip | Using stored MLP output | Spatial | t 496 | previous 544 | block 8
Skip | Using stored MLP output | Time | t 496 | previous 544 | block 8
W0629 23:04:41.359000 139967332734784 torch/distributed/elastic/agent/server/api.py:741] Received Signals.SIGINT death signal, shutting down workers
W0629 23:04:41.360000 139967332734784 torch/distributed/elastic/multiprocessing/api.py:851] Sending process 2637142 closing signal SIGINT

 78%|███████▊  | 21/27 [00:34<00:09,  1.63s/it]
[rank0]: Traceback (most recent call last):
[rank0]:   File "/home/jin509/OpenDiT/scripts/opensora/sample_opensora_skip.py", line 424, in <module>
[rank0]:     main(args)
[rank0]:   File "/home/jin509/OpenDiT/scripts/opensora/sample_opensora_skip.py", line 306, in main
[rank0]:     samples = scheduler.sample(
[rank0]:   File "/home/jin509/OpenDiT/opendit/models/opensora/rflow_skip.py", line 255, in sample
[rank0]:     output = model(z_in, t, all_timesteps, **model_args)
[rank0]:   File "/home/jin509/anaconda3/envs/opendit/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:   File "/home/jin509/anaconda3/envs/opendit/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:   File "/home/jin509/OpenDiT/opendit/models/opensora/stdit3_skip.py", line 513, in forward
[rank0]:     x, self.temporal_mlp_outputs = auto_grad_checkpoint(
[rank0]:   File "/home/jin509/OpenDiT/opendit/models/opensora/utils.py", line 191, in auto_grad_checkpoint
[rank0]:     result = module(*args, **kwargs)
[rank0]:   File "/home/jin509/anaconda3/envs/opendit/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:   File "/home/jin509/anaconda3/envs/opendit/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:   File "/home/jin509/OpenDiT/opendit/models/opensora/stdit3_skip.py", line 183, in forward
[rank0]:     int(timestep[0]), self.mlp_count, self.block_idx, all_timesteps
[rank0]: KeyboardInterrupt
Traceback (most recent call last):
  File "/home/jin509/anaconda3/envs/opendit/bin/torchrun", line 8, in <module>
    sys.exit(main())
  File "/home/jin509/anaconda3/envs/opendit/lib/python3.10/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 347, in wrapper
    return f(*args, **kwargs)
  File "/home/jin509/anaconda3/envs/opendit/lib/python3.10/site-packages/torch/distributed/run.py", line 879, in main
    run(args)
  File "/home/jin509/anaconda3/envs/opendit/lib/python3.10/site-packages/torch/distributed/run.py", line 870, in run
    elastic_launch(
  File "/home/jin509/anaconda3/envs/opendit/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 132, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/jin509/anaconda3/envs/opendit/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 254, in launch_agent
    result = agent.run()
  File "/home/jin509/anaconda3/envs/opendit/lib/python3.10/site-packages/torch/distributed/elastic/metrics/api.py", line 123, in wrapper
    result = f(*args, **kwargs)
  File "/home/jin509/anaconda3/envs/opendit/lib/python3.10/site-packages/torch/distributed/elastic/agent/server/api.py", line 733, in run
    result = self._invoke_run(role)
  File "/home/jin509/anaconda3/envs/opendit/lib/python3.10/site-packages/torch/distributed/elastic/agent/server/api.py", line 876, in _invoke_run
    time.sleep(monitor_interval)
  File "/home/jin509/anaconda3/envs/opendit/lib/python3.10/site-packages/torch/distributed/elastic/multiprocessing/api.py", line 76, in _terminate_process_handler
    raise SignalException(f"Process {os.getpid()} got signal: {sigval}", sigval=sigval)
torch.distributed.elastic.multiprocessing.api.SignalException: Process 2637042 got signal: 2
