/home/jin509/anaconda3/envs/opendit/lib/python3.10/site-packages/transformers/utils/generic.py:441: UserWarning: torch.utils._pytree._register_pytree_node is deprecated. Please use torch.utils._pytree.register_pytree_node instead.
  _torch_pytree._register_pytree_node(
/home/jin509/anaconda3/envs/opendit/lib/python3.10/site-packages/transformers/utils/generic.py:309: UserWarning: torch.utils._pytree._register_pytree_node is deprecated. Please use torch.utils._pytree.register_pytree_node instead.
  _torch_pytree._register_pytree_node(
/home/jin509/anaconda3/envs/opendit/lib/python3.10/site-packages/transformers/utils/generic.py:309: UserWarning: torch.utils._pytree._register_pytree_node is deprecated. Please use torch.utils._pytree.register_pytree_node instead.
  _torch_pytree._register_pytree_node(
/home/jin509/anaconda3/envs/opendit/lib/python3.10/site-packages/transformers/utils/generic.py:309: UserWarning: torch.utils._pytree._register_pytree_node is deprecated. Please use torch.utils._pytree.register_pytree_node instead.
  _torch_pytree._register_pytree_node(
/home/jin509/anaconda3/envs/opendit/lib/python3.10/site-packages/diffusers/models/transformers/transformer_2d.py:34: FutureWarning: `Transformer2DModelOutput` is deprecated and will be removed in version 1.0.0. Importing `Transformer2DModelOutput` from `diffusers.models.transformer_2d` is deprecated and this will be removed in a future version. Please use `from diffusers.models.modeling_outputs import Transformer2DModelOutput`, instead.
  deprecate("Transformer2DModelOutput", "1.0.0", deprecation_message)
[06/29/24 22:25:08] INFO     colossalai - colossalai - INFO: /home/jin509/anaconda3/envs/opendit/lib/python3.10/site-packages/colossalai/initialize.py:60 launch
                    INFO     colossalai - colossalai - INFO: Distributed environment is initialized, world size: 1

Init SkipManager:
                steps=30
                cross_skip=True, cross_threshold=[540, 960], cross_gap=6
                spatial_skip=True, spatial_threshold=[540, 920], spatial_gap=2, spatial_layer_range=[0, 28]
                temporal_skip=True, temporal_threshold=[540, 960], temporal_gap=4
                diffusion_skip=True, diffusion_timestep_respacing=None

[[34m2024-06-29 22:25:08[0m] Inference configuration: Namespace(config='configs/opensora/sample_skip.yaml', seed=42, batch_size=1, flash_attn=True, resolution='480p', multi_resolution='STDiT2', dtype='bf16', save_dir='./samples/opensora', num_sample=1, prompt_as_path=True, verbose=2, prompt_path=None, prompt=['a cat wearing sunglasses and working as a lifeguard at pool.', 'A dog in astronaut suit and sunglasses floating in space.'], llm_refine=False, num_frames=48, fps=24, image_size=None, frame_interval=1, aspect_ratio='9:16', watermark=False, num_sampling_steps=30, cfg_scale=7.0, loop=1, align=5, condition_frame_length=5, condition_frame_edit=0.0, reference_path=None, mask_strategy=None, aes=6.5, flow=None, camera_motion=None, spatial_skip=True, spatial_threshold=[540, 920], spatial_gap=2, spatial_block=[0, 28], temporal_skip=True, temporal_threshold=[540, 960], temporal_gap=4, cross_skip=True, cross_threshold=[540, 960], cross_gap=6, mlp_skip=False, mlp_threshold=[710, 760], mlp_gap=1, mlp_layer_range=[14, 15], mlp_skip_config={496: [0, 1, 2, 3], 588: [0, 1, 2, 3, 4], 644: [0, 1, 2, 3, 4], 724: [0, 1, 2, 3, 4], 776: [0, 1, 2, 3, 4], 820: [0, 1, 2, 3, 4]}, diffusion_skip=True, diffusion_skip_timestep=[1, 1, 1, 0, 0, 0, 0, 0, 0, 0])

[[34m2024-06-29 22:25:08[0m] Building models...
/home/jin509/anaconda3/envs/opendit/lib/python3.10/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
You are using the default legacy behaviour of the <class 'transformers.models.t5.tokenization_t5.T5Tokenizer'>. This is expected, and simply means that the `legacy` (previous) behavior will be used so nothing changes for you. If you want to use the new behaviour, set `legacy=False`. This should only be set if you understand what it means, and thouroughly read the reason why this was added as explained in https://github.com/huggingface/transformers/pull/24565

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:20<00:20, 20.46s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:35<00:00, 17.15s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:35<00:00, 17.64s/it]
save_dir | ./samples/opensora

  0%|          | 0/27 [00:00<?, ?it/s]
  4%|▎         | 1/27 [00:05<02:21,  5.44s/it]
  7%|▋         | 2/27 [00:07<01:32,  3.71s/it]
 11%|█         | 3/27 [00:10<01:14,  3.09s/it]
 15%|█▍        | 4/27 [00:11<00:56,  2.45s/it]
 19%|█▊        | 5/27 [00:13<00:51,  2.34s/it]
 22%|██▏       | 6/27 [00:14<00:39,  1.87s/it]
 26%|██▌       | 7/27 [00:16<00:36,  1.81s/it]
 30%|██▉       | 8/27 [00:17<00:29,  1.54s/it]
 33%|███▎      | 9/27 [00:19<00:31,  1.72s/it]
 37%|███▋      | 10/27 [00:20<00:25,  1.49s/it]
 41%|████      | 11/27 [00:22<00:23,  1.48s/it]
 44%|████▍     | 12/27 [00:23<00:19,  1.33s/it]
 48%|████▊     | 13/27 [00:25<00:22,  1.63s/it]
 52%|█████▏    | 14/27 [00:26<00:18,  1.43s/it]
 56%|█████▌    | 15/27 [00:27<00:17,  1.45s/it]
 59%|█████▉    | 16/27 [00:28<00:14,  1.30s/it]
 63%|██████▎   | 17/27 [00:30<00:15,  1.55s/it]
 67%|██████▋   | 18/27 [00:31<00:12,  1.38s/it]
 70%|███████   | 19/27 [00:33<00:11,  1.48s/it]
 74%|███████▍  | 20/27 [00:34<00:09,  1.32s/it]
 78%|███████▊  | 21/27 [00:36<00:09,  1.57s/it]
 81%|████████▏ | 22/27 [00:39<00:09,  1.80s/it]
 85%|████████▌ | 23/27 [00:41<00:07,  1.97s/it]
 89%|████████▉ | 24/27 [00:43<00:06,  2.09s/it]
 93%|█████████▎| 25/27 [00:46<00:04,  2.17s/it]
 96%|█████████▋| 26/27 [00:48<00:02,  2.23s/it]
100%|██████████| 27/27 [00:50<00:00,  2.27s/it]
100%|██████████| 27/27 [00:50<00:00,  1.88s/it]
[[34m2024-06-29 22:26:47[0m] Prompt: a cat wearing sunglasses and working as a lifeguard at pool. aesthetic score: 6.5.
Saved to ./samples/opensora/a cat wearing sunglasses and working as .mp4

  0%|          | 0/27 [00:00<?, ?it/s]
  4%|▎         | 1/27 [00:02<01:01,  2.35s/it]
  7%|▋         | 2/27 [00:04<00:58,  2.36s/it]
 11%|█         | 3/27 [00:07<00:56,  2.36s/it]
 15%|█▍        | 4/27 [00:09<00:54,  2.36s/it]
 19%|█▊        | 5/27 [00:10<00:45,  2.05s/it]
 22%|██▏       | 6/27 [00:12<00:39,  1.87s/it]
 26%|██▌       | 7/27 [00:13<00:31,  1.57s/it]
 30%|██▉       | 8/27 [00:15<00:33,  1.76s/it]
 33%|███▎      | 9/27 [00:16<00:27,  1.51s/it]
 37%|███▋      | 10/27 [00:18<00:26,  1.58s/it]
 41%|████      | 11/27 [00:19<00:22,  1.39s/it]
 44%|████▍     | 12/27 [00:21<00:24,  1.62s/it]
 48%|████▊     | 13/27 [00:22<00:19,  1.43s/it]
 52%|█████▏    | 14/27 [00:23<00:18,  1.45s/it]
 56%|█████▌    | 15/27 [00:24<00:15,  1.31s/it]
 59%|█████▉    | 16/27 [00:27<00:17,  1.63s/it]
 63%|██████▎   | 17/27 [00:28<00:14,  1.43s/it]
 67%|██████▋   | 18/27 [00:29<00:13,  1.46s/it]
 70%|███████   | 19/27 [00:30<00:10,  1.31s/it]
 74%|███████▍  | 20/27 [00:32<00:10,  1.56s/it]
 78%|███████▊  | 21/27 [00:33<00:08,  1.39s/it]
 81%|████████▏ | 22/27 [00:36<00:08,  1.68s/it]
 85%|████████▌ | 23/27 [00:38<00:07,  1.89s/it]
 89%|████████▉ | 24/27 [00:40<00:06,  2.04s/it]
 93%|█████████▎| 25/27 [00:43<00:04,  2.14s/it]
 96%|█████████▋| 26/27 [00:45<00:02,  2.21s/it]
100%|██████████| 27/27 [00:48<00:00,  2.26s/it]
100%|██████████| 27/27 [00:48<00:00,  1.78s/it]
[[34m2024-06-29 22:27:41[0m] Prompt: a dog in astronaut suit and sunglasses floating in space. aesthetic score: 6.5.
Saved to ./samples/opensora/A dog in astronaut suit and sunglasses f.mp4
[[34m2024-06-29 22:27:43[0m] Inference finished.
[[34m2024-06-29 22:27:43[0m] Saved samples to ./samples/opensora
